<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE --><html lang="en" class="no-js"><head><meta charset="utf-8"> <!-- begin _includes/seo.html --><title>Bash Notes - Part 1 - Glob Attack</title><meta name="description" content="Introduction"><meta name="author" content="Samuel SAYAG"><meta property="article:author" content="Samuel SAYAG"><meta property="og:type" content="article"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="Glob Attack"><meta property="og:title" content="Bash Notes - Part 1"><meta property="og:url" content="htps://samuelsayag.github.io/bash/notes/1"><meta property="og:description" content="Introduction"><meta property="og:image" content="htps://samuelsayag.github.io/assets/images/terminal-1.jpg"><meta property="article:published_time" content="2021-01-28T00:00:00+02:00"><link rel="canonical" href="htps://samuelsayag.github.io/bash/notes/1"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "Person", "name": "Samuel SAYAG", "url": "htps://samuelsayag.github.io/" } </script> <!-- end _includes/seo.html --><link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Glob Attack Feed"> <!-- https://t.co/dKP3o1e --><meta name="viewport" content="width=device-width, initial-scale=1.0"> <script> document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js '; </script> <!-- For all browsers --><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"> <!--[if IE]><style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; }</style><![endif]--> <!-- start custom head snippets --> <!-- insert favicons. use https://realfavicongenerator.net/ --> <!-- end custom head snippets --></head><body class="layout--single"><nav class="skip-links"><h2 class="screen-reader-text">Skip links</h2><ul><li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li><li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li><li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li></ul></nav><!--[if lt IE 9]><div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]--><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><nav id="site-nav" class="greedy-nav"> <a class="site-title" href="/"> <span class="site-subtitle">Sam's Blog</span> </a><ul class="visible-links"></ul><button class="greedy-nav__toggle hidden" type="button"> <span class="visually-hidden">Toggle menu</span><div class="navicon"></div></button><ul class="hidden-links hidden"></ul></nav></div></div></div><div class="initial-content"><div class="page__hero--overlay" style=" background-image: url('/assets/images/terminal-1.jpg');" ><div class="wrapper"><h1 id="page-title" class="page__title" itemprop="headline"> Bash Notes - Part 1</h1><p class="page__lead"><h2 id="introduction">Introduction</h2></p><p class="page__meta"> <span class="page__meta-date"> <i class="far fa-calendar-alt" aria-hidden="true"></i> <time datetime="2021-01-28T00:00:00+02:00">January 28, 2021</time> </span> <span class="page__meta-sep"></span> <span class="page__meta-readtime"> <i class="far fa-clock" aria-hidden="true"></i> 4 minute read </span></p></div></div><div id="main" role="main"><div class="sidebar sticky"><div itemscope itemtype="https://schema.org/Person"><div class="author__avatar"> <img src="/assets/images/carte.jpg" alt="Samuel SAYAG" itemprop="image"></div><div class="author__content"><h3 class="author__name" itemprop="name">Samuel SAYAG</h3><div class="author__bio" itemprop="description"><p>I am a father, software engineer, pyout listener…and much more.</p></div></div><div class="author__urls-wrapper"> <button class="btn btn--inverse">Follow</button><ul class="author__urls social-icons"><li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place"> <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Jerusalem, Israel</span></li><li> <a href="mailto:globattack@gmail.com"><meta itemprop="email" content="globattack@gmail.com" /> <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span> </a></li><!--<li> <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link </a></li>--></ul></div></div></div><article class="page" itemscope itemtype="https://schema.org/CreativeWork"><meta itemprop="headline" content="Bash Notes - Part 1"><meta itemprop="description" content="Introduction"><meta itemprop="datePublished" content="2021-01-28T00:00:00+02:00"><div class="page__inner-wrap"><section class="page__content" itemprop="text"><aside class="sidebar__right "><nav class="toc"><header><h4 class="nav__title"><i class="fas fa-cog"></i> Table of Contents</h4></header><ul class="toc__menu"><li><a href="#introduction">Introduction</a></li><li><a href="#getting-help-out-of--man-bash">Getting Help (out of $ man bash)</a></li><li><a href="#variable-and-parameters">Variable and parameters</a><ul><li><a href="#variables">Variables</a></li><li><a href="#script-execution-shellsub-shell">Script execution (shell/sub-shell)</a></li><li><a href="#sourcing-other-scripts">Sourcing other scripts</a></li><li><a href="#quoting">Quoting</a></li><li><a href="#handling-script-arguments">Handling script arguments</a></li><li><a href="#command-substitution">Command substitution</a></li><li><a href="#test-string">Test string</a></li><li><a href="#here-document">Here document</a></li></ul></li><li><a href="#tips">Tips</a><ul><li><a href="#empty-a-file-completly-without-erasing-it">Empty a file completly without erasing it</a></li><li><a href="#debug-a-script-to-see-where-it-f-up">Debug a script to see where it F#*$@&amp;!-up</a></li><li><a href="#read-an-array-of-variable">Read an array of variable</a></li></ul></li><li><a href="#best-practice">Best practice</a></li></ul></nav></aside><h2 id="introduction">Introduction</h2><p>Not so long ago, I decided I needed to learn Bash more seriously. I already coded a bit in Bash, but all my knowledge was made of meaning inferrence from code in various blogs and StackOverflow etc.</p><p>While this is a perfect way to learn when you want practical (fast) results, you end-up gropping around a bit too much when you want to make something new without mentioning not having a single idea of certain feature being available that could save your life :)</p><p>This post is <strong>NOT</strong>:</p><ul><li>A tutorial (but could be <em>maybe</em> used as one)</li><li>A complete reference of the Bash scripting language. <a href="https://tldp.org/guides.html">This is one</a></li><li>A quick unexplicative post about a single feature of the language…there is more than enough</li></ul><p>These are simply my note of the excellente course of <a href="https://www.sandervanvugt.com/course/bash-scripting-fundamentals-livelessons/">Sander Van Vugt</a> that I want to keep organised and maybe useful to others.</p><p>Like every course notes, one makes the maximum of it when it already have some knowledge (even scattered) and have to organise them, review a technical point, grab some useful tips and know-how.</p><p>Eventually, this is the first post (Part I) but there will be more as I continue to learn.</p><p>Hope it will serve you well! :)</p><h2 id="getting-help-out-of--man-bash">Getting Help (out of <code class="language-plaintext highlighter-rouge">$ man bash</code>)</h2><p>When you name a script beware that:</p><ul><li>You have to put it on your <code class="language-plaintext highlighter-rouge">$PATH</code></li><li>When name conflicts occurs (because the name of the script is an executable already existing in your system), this precedence is applied:<ul><li>internal command</li><li>external command</li><li>your scipt</li></ul></li></ul><p>Internal commands which existence can be tested with:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">type</span> &lt;name-of-command&gt;
</code></pre></div></div><p>External commands which existence can be tested with:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>which &lt;name-of-command&gt;
</code></pre></div></div><p>Get the list of the list of internal commands and optionally get some help about a specific command.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">help</span> <span class="o">[</span><span class="nb">command </span>name]
</code></pre></div></div><p>The authoritative doc is: <a href="https://tldp.org/guides.html">here</a></p><h2 id="variable-and-parameters">Variable and parameters</h2><ul><li>Don’t forget the <code class="language-plaintext highlighter-rouge">shebang</code>: <code class="language-plaintext highlighter-rouge">#!/bin/bash</code>. It gives the bash the language of the script in order to find the correct interpreter.</li><li>Put some comment explaining the purpose of the script</li><li>Put some usage information</li><li>Put <code class="language-plaintext highlighter-rouge">exit 0</code> at the end of the script.</li></ul><p>The last executed command exit status can be access with the variable: <code class="language-plaintext highlighter-rouge">$?</code>.</p><h3 id="variables">Variables</h3><p>You can define them:</p><ul><li>statically: <code class="language-plaintext highlighter-rouge">MY_VAR=foo</code> or <code class="language-plaintext highlighter-rouge">export MY_VAR=foo</code> (if you want any sub-shell to access it),</li><li>or as arguments of the script $0, $1, $2…</li><li>or interactively with <code class="language-plaintext highlighter-rouge">read</code>.</li></ul><p>Variable are accessed with <code class="language-plaintext highlighter-rouge">$</code>. For instance: <code class="language-plaintext highlighter-rouge">$MY_VAR</code></p><h3 id="script-execution-shellsub-shell">Script execution (shell/sub-shell)</h3><ul><li>A script (when lauched for instance by: ./my-script) is going to be executed in a <em>sub-shell</em>. Before the execution 2 script are going to be executed: <code class="language-plaintext highlighter-rouge">/etc/bash.bashrc</code> and <code class="language-plaintext highlighter-rouge">~/.bashrc</code>.</li><li>If it is a <em>login-shell</em> 2 other file are executed first: <code class="language-plaintext highlighter-rouge">/etc/profile</code> and <code class="language-plaintext highlighter-rouge">~/.profile</code>.</li><li>Good explanation about shell and sub-shell: <a href="https://askubuntu.com/questions/155865/what-are-login-and-non-login-shells">here</a></li></ul><h3 id="sourcing-other-scripts">Sourcing other scripts</h3><p>Inside your script put:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span> /path/of/the/sourced/script
</code></pre></div></div><p>alternatively</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /path/of/the/sourced/script
</code></pre></div></div><blockquote><p>The main idea for a system script (even a small one), is to have <strong>static code</strong> in the <em>sourced file</em> and the <strong>dynamic code</strong> in the <em>called script</em>.</p></blockquote><blockquote><p><strong>!!! Danger !!!</strong> don’t put <code class="language-plaintext highlighter-rouge">exit codes</code> in a <em>sourced script</em> (if you source it in your <em>current shell</em> then the exit would close your working shell)</p></blockquote><h3 id="quoting">Quoting</h3><p>Reserved character (that need <em>quoting</em>):</p><table><thead><tr><th style="text-align: center">Character</th><th>Meaning</th><th style="text-align: center">Character</th><th>Meaning</th></tr></thead><tbody><tr><td style="text-align: center">~</td><td>home dir</td><td style="text-align: center">]</td><td>end char set wildcard</td></tr><tr><td style="text-align: center">`</td><td>command substitution</td><td style="text-align: center">{</td><td>start code block</td></tr><tr><td style="text-align: center">#</td><td>comment</td><td style="text-align: center">}</td><td>end code block</td></tr><tr><td style="text-align: center">$</td><td>variable expansion</td><td style="text-align: center">;</td><td>command separator</td></tr><tr><td style="text-align: center">&amp;</td><td>background job</td><td style="text-align: center">’</td><td>strong quote</td></tr><tr><td style="text-align: center">*</td><td>wildcard string</td><td style="text-align: center">”</td><td>weak quote</td></tr><tr><td style="text-align: center">(</td><td>start sub-shell</td><td style="text-align: center">&lt;</td><td>input redirection</td></tr><tr><td style="text-align: center">)</td><td>end sub-shell</td><td style="text-align: center">&gt;</td><td>output redirection</td></tr><tr><td style="text-align: center">\</td><td>escape</td><td style="text-align: center">/</td><td>path separator</td></tr><tr><td style="text-align: center">|</td><td>pipe</td><td style="text-align: center">?</td><td>single char wildcard</td></tr><tr><td style="text-align: center">[</td><td>start char set wildcard</td><td style="text-align: center"> </td><td> </td></tr></tbody></table><ul><li>“hard” quote are <code class="language-plaintext highlighter-rouge">'</code> and nothing is interpreted in it</li><li>“weak” quote are <code class="language-plaintext highlighter-rouge">"</code> and <em>variable</em>, <em>command substitution</em> and _ <em>arithmetic expression</em> are interpreted in it</li></ul><h3 id="handling-script-arguments">Handling script arguments</h3><table><thead><tr><th style="text-align: center">Variable</th><th>Meaning</th><th>Variable</th><th>Meaning</th></tr></thead><tbody><tr><td style="text-align: center">$0</td><td>absolute path of the script</td><td>$*</td><td>string of all arguments</td></tr><tr><td style="text-align: center">$1</td><td>first argument ($1…9 possible)</td><td>$#</td><td>number of arguments</td></tr><tr><td style="text-align: center">$9</td><td>last argument accessible with $n</td><td>$@</td><td>array of all arguments</td></tr><tr><td style="text-align: center">more arg</td><td>use ${} (not compatible with all shells) or <code class="language-plaintext highlighter-rouge">shift</code></td><td> </td><td> </td></tr></tbody></table><ul><li>most of the time for number of arg <code class="language-plaintext highlighter-rouge">(n &gt; 9)</code> use <code class="language-plaintext highlighter-rouge">${n}</code></li><li><code class="language-plaintext highlighter-rouge">shift</code> is the only really compatible command no matter the shell.</li></ul><h3 id="command-substitution">Command substitution</h3><p>Command substitution allows the output of a command to replace the command itself.</p><ul><li>deprecated: <code class="language-plaintext highlighter-rouge">`&lt;my-command`</code></li><li>recommended: <code class="language-plaintext highlighter-rouge">$(&lt;my-command&gt;)</code></li></ul><h3 id="test-string">Test string</h3><ul><li><code class="language-plaintext highlighter-rouge">test -z $1 &amp;&amp; exit 1</code> (is checking for <code class="language-plaintext highlighter-rouge">$1</code> to be empty and exit if it is the case</li><li><code class="language-plaintext highlighter-rouge">[[ $1=='[a-z]*' ]] || echo $1 does not start with a letter</code> (check if the variable $1 respect the given pattern and echo a message if not)</li></ul><p>Note: <strong>!!Warning!!</strong> put no space afer the variable name <code class="language-plaintext highlighter-rouge">[[ $1 == pattern ]]</code> is wrong because the shell would search for a variable called <code class="language-plaintext highlighter-rouge">$1 </code> instead of <code class="language-plaintext highlighter-rouge">$1</code></p><h3 id="here-document">Here document</h3><p>Useful when you want to send many arguments to the same commands such as <code class="language-plaintext highlighter-rouge">echo</code> or commands that require interactive interaction such as <code class="language-plaintext highlighter-rouge">lftp</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span>  <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
hello
print this
print that
bye
</span><span class="no">EOF
</span></code></pre></div></div><p>more interesting</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lftp &lt;<span class="nb">hostname</span><span class="o">&gt;</span> <span class="o">&lt;&lt;</span><span class="no">EndOfSession</span><span class="sh">
ls
get &lt;file/path&gt;
bye
</span><span class="no">EndOfSession
</span></code></pre></div></div><h2 id="tips">Tips</h2><h3 id="empty-a-file-completly-without-erasing-it">Empty a file completly without erasing it</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat</span> /dev/nul <span class="o">&gt;</span> the-file-to-be-emptied
</code></pre></div></div><h3 id="debug-a-script-to-see-where-it-f-up">Debug a script to see where it F#*$@&amp;!-up</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bash <span class="nt">-x</span> &lt;my-script&gt;
</code></pre></div></div><h3 id="read-an-array-of-variable">Read an array of variable</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">read</span> <span class="nt">-a</span> &lt;my-array-var&gt;
</code></pre></div></div><h2 id="best-practice">Best practice</h2><ul><li>Use upper case just for variable names inside scripts</li><li>Separate <em>static</em> from <em>dynamic</em> code in scripts so that the <em>static</em> part can be portable.</li><li>Always use <code class="language-plaintext highlighter-rouge">'</code> until you need <code class="language-plaintext highlighter-rouge">"</code></li></ul></section><footer class="page__meta"><p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-01-28T00:00:00+02:00">January 28, 2021</time></p></footer><section class="page__share"> <a href="https://twitter.com/intent/tweet?text=Bash+Notes+-+Part+1%20htps%3A%2F%2Fsamuelsayag.github.io%2Fbash%2Fnotes%2F1" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=htps%3A%2F%2Fsamuelsayag.github.io%2Fbash%2Fnotes%2F1" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=htps%3A%2F%2Fsamuelsayag.github.io%2Fbash%2Fnotes%2F1" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a></section></div></article><div class="page__related"><h4 class="page__related-title">You May Also Enjoy</h4><div class="grid__wrapper"></div></div></div></div><div id="footer" class="page__footer"><footer> <!-- start custom footer snippets --> <!-- end custom footer snippets --><div class="page__footer-follow"><ul class="social-icons"><li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li></ul></div><div class="page__footer-copyright">&copy; 2021 Samuel SAYAG. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div></footer></div><script src="/assets/js/main.min.js"></script></body></html>
